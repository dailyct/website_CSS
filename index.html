<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹å­Ÿå¸† | å€‹äººæª”æ¡ˆèˆ‡ä½œå“é›†</title>
    <meta name="description" content="ç‹å­Ÿå¸†çš„å€‹äººéƒ¨è½æ ¼ï¼Œå±•ç¤ºäººå·¥æ™ºæ…§ã€ç¨‹å¼è¨­è¨ˆä½œå“èˆ‡å¤šåª’é«”å‰µä½œã€‚">
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#0a0a0a',
                        secondary: '#141414',
                        accent: '#e5c07b',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                        serif: ['Times New Roman', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* =========================================
           2. CSS è®Šæ•¸å®šç¾© (Design System)
           ä»¿é³´æ½®é¢¨æ ¼ï¼šæ·±é‚ƒé»‘ã€ç§‘æŠ€ç°ã€å…±é³´é‡‘/é’
           ========================================= */
        :root {
            /* è‰²å½©ç³»çµ± */
            --bg-primary: #0a0a0a;       /* æ·±é»‘èƒŒæ™¯ */
            --bg-secondary: #141414;     /* æ¬¡ç´šèƒŒæ™¯ */
            --bg-glass: rgba(10, 10, 10, 0.85); /* ç»ç’ƒæ“¬æ…‹ */
            
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            
            --accent-color: #e5c07b;     /* é³´æ½®é‡‘/é»ƒè‰²èª¿ */
            --accent-glow: rgba(229, 192, 123, 0.3);
            --border-color: #333333;

            /* å­—é«”ç³»çµ± */
            --font-main: 'Inter', 'Noto Sans TC', system-ui, -apple-system, sans-serif;
            
            /* é–“è·èˆ‡å°ºå¯¸ */
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 32px;
            --spacing-xl: 64px;
            --container-width: 1200px;
            --header-height: 70px;
            
            /* å‹•ç•« */
            --transition-speed: 0.3s;
        }

        /* =========================================
           3. CSS Reset & Base Styles
           ========================================= */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden; /* é˜²æ­¢æ©«å‘æ»¾å‹• */
        }

        a {
            text-decoration: none;
            color: inherit;
            transition: color var(--transition-speed);
        }

        ul {
            list-style: none;
        }

        img, video, iframe {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* å¯¦ç”¨é¡åˆ¥ï¼šæ¨™è¨˜é«˜äº® */
        mark {
            background-color: transparent;
            color: var(--accent-color);
            font-weight: bold;
            text-shadow: 0 0 5px var(--accent-glow);
        }

        /* =========================================
           4. Layout Components (Header & Nav)
           ========================================= */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background-color: var(--bg-glass);
            backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }

        .navbar-container {
            max-width: var(--container-width);
            margin: 0 auto;
            height: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 var(--spacing-md);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 2px;
            color: var(--text-primary);
        }

        .logo span {
            color: var(--accent-color);
        }

        /* æ¡Œé¢å°èˆª */
        .nav-links {
            display: flex;
            gap: var(--spacing-lg);
        }

        .nav-links a {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            position: relative;
        }

        .nav-links a:hover, .nav-links a.active {
            color: var(--text-primary);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0%;
            height: 2px;
            background-color: var(--accent-color);
            transition: width var(--transition-speed);
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        /* æ¼¢å ¡é¸å–®æŒ‰éˆ• (Mobile Only) */
        .menu-toggle {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        /* =========================================
           5. Main Content Sections
           ========================================= */
        main {
            margin-top: var(--header-height);
        }

        /* é€šç”¨å€å¡Šæ¨£å¼ */
        section, article {
            padding: var(--spacing-xl) var(--spacing-md);
            max-width: var(--container-width);
            margin: 0 auto;
            border-bottom: 1px solid var(--border-color);
        }

        /* å€å¡Šæ¨™é¡Œ */
        .section-title {
            font-size: 2rem;
            margin-bottom: var(--spacing-lg);
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background-color: var(--accent-color);
            margin: 10px auto 0;
        }

        /* --- Hero Section (é¦–é ) --- */
        #hero {
            height: calc(100vh - var(--header-height));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            border-bottom: none;
        }

        .hero-content {
            text-align: center;
            z-index: 2;
            animation: fadeInUp 1s ease-out;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            margin-bottom: var(--spacing-sm);
            text-shadow: 0 0 20px rgba(0,0,0,0.8);
        }

        .hero-content p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        .btn-cta {
            display: inline-block;
            padding: 12px 30px;
            background-color: transparent;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            font-weight: bold;
            letter-spacing: 2px;
            transition: all var(--transition-speed);
        }

        .btn-cta:hover {
            background-color: var(--accent-color);
            color: var(--bg-primary);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        /* --- About Section (é—œæ–¼æˆ‘) --- */
        .about-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: var(--spacing-lg);
            align-items: center;
        }

        .profile-card {
            background: var(--bg-secondary);
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .profile-img {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 50%;
            margin: 0 auto var(--spacing-md);
            border: 2px solid var(--accent-color);
        }

        .notice-box {
            background: rgba(255, 255, 255, 0.05);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-left: 3px solid var(--accent-color);
            font-size: 0.9rem;
        }

        /* --- Experience & Skills (ç¶“æ­·èˆ‡æŠ€èƒ½) --- */
        .grid-2-cols {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-lg);
        }

        /* è‡ªå®šç¾©è¡¨æ ¼æ¨£å¼ */
        .tech-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-secondary);
            margin-top: var(--spacing-md);
        }

        .tech-table th, .tech-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .tech-table th {
            color: var(--accent-color);
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        /* --- Portfolio Section (ä½œå“é›†) --- */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
        }

        .media-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: transform var(--transition-speed);
        }

        .media-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color);
        }

        .media-content {
            padding: var(--spacing-md);
        }

        .media-content h3 {
            font-size: 1.1rem;
            margin-bottom: var(--spacing-sm);
        }

        /* éŸ³è¨Šæ’­æ”¾å™¨æ¨£å¼å„ªåŒ– */
        audio {
            width: 100%;
            filter: invert(0.9); /* è®“é è¨­æ’­æ”¾å™¨è®Šæš—è‰²ç³» */
        }

        /* --- Contact (è¯çµ¡) --- */
        .contact-footer {
            background-color: var(--bg-secondary);
            padding: var(--spacing-xl) 0;
            text-align: center;
            border-top: 1px solid var(--accent-color);
        }

        /* =========================================
           6. RWD Media Queries (Mobile First)
           ========================================= */
        @media (max-width: 768px) {
            .nav-links {
                position: fixed;
                top: var(--header-height);
                right: -100%;
                width: 70%;
                height: calc(100vh - var(--header-height));
                background-color: var(--bg-primary);
                flex-direction: column;
                align-items: center;
                justify-content: center;
                transition: right var(--transition-speed);
                border-left: 1px solid var(--border-color);
            }

            .nav-links.active {
                right: 0;
            }

            .menu-toggle {
                display: block;
            }

            .about-grid, .grid-2-cols {
                grid-template-columns: 1fr;
            }

            .hero-content h1 {
                font-size: 2.5rem;
            }
        }

        /* =========================================
           7. Animations
           ========================================= */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            will-change: opacity, visibility;
        }

        .fade-in-section.is-visible {
            opacity: 1;
            transform: none;
        }
    </style>
</head>
<body>

    <header>
        <div class="navbar-container">
            <a href="#" class="logo">WANG<span>.MF</span></a>
            <div class="menu-toggle" id="mobile-menu">â˜°</div>
            <nav class="nav-links" id="nav-links">
                <a href="#hero">é¦–é </a>
                <a href="#about">é—œæ–¼æˆ‘</a>
                <a href="#portfolio">å°ˆæ¡ˆä½œå“</a>
                <a href="#others">æ›´å¤šè³‡è¨Š</a>
                <a href="#contact">è¯çµ¡æˆ‘</a>
            </nav>
        </div>
    </header>

    <main>
        <section id="hero">
            <div class="hero-content">
                <h1>ç‹å­Ÿå¸†</h1>
                <p>äººå·¥æ™ºæ…§æ•™è‚²è€… | Python é–‹ç™¼è€… | æ•¸ä½å…§å®¹å‰µä½œè€…</p>
                <br>
                <a href="#portfolio" class="btn-cta">æŸ¥çœ‹ä½œå“é›†</a>
            </div>
        </section>

        <article id="about" class="fade-in-section">
            <h2 class="section-title">é—œæ–¼æˆ‘</h2>
            <div class="about-grid">
                <div class="profile-card">
                    <img src="https://placehold.co/300x300/1a1a1a/e5c07b?text=Morris" alt="ç‹å­Ÿå¸† Profile Picture" class="profile-img">
                    <h3>ç‹å­Ÿå¸†</h3>
                    <p style="color: var(--accent-color); margin-top: 5px;">åœ‹ç«‹å°åŒ—æ•™è‚²å¤§å­¸</p>
                    <hr style="border-color: #333; margin: 15px 0;">
                    <p>å­¸ç”Ÿ / æ•™æˆ</p>
                </div>

                <div class="profile-details">
                    <div class="notice-box">
                        <strong>NOTICE:</strong> è©²å€‹äººåœ–ç‰‡ç‚ºæœ¬äººå§”è¨—ç¹ªå¸«æ‰€ç¹ªï¼Œè«‹å‹¿ä»»æ„è½‰è¼‰!!
                    </div>

                    <p>åœ¨æ­¤éƒ¨è½æ ¼ä¸­ï¼Œå°‡åˆ†äº«æˆ‘åœ¨å·¥ä½œä¸ŠåŠç”Ÿæ´»ä¸­çš„é»æ»´ã€‚</p>
                    <br>
                    <p>æˆ‘æ˜¯ä¸€ä½å¤§å­¸æ•™æˆï¼Œå°ˆæ³¨æ•™æˆ <mark>äººå·¥æ™ºæ…§</mark> å’Œ <mark>Python ç¨‹å¼è¨­è¨ˆ</mark>ï¼Œä¸¦è‡´åŠ›æ–¼ <mark>æ·±åº¦å­¸ç¿’</mark> èˆ‡ <mark>ç”Ÿæˆå¼ AI</mark> åœ¨æ•™è‚²åŠå·¥ç¨‹æ‡‰ç”¨ä¸Šçš„å‰µæ–°ç ”ç©¶èˆ‡æ‡‰ç”¨ã€‚</p>
                    <br>
                    <p>æ­¤å¤–ï¼Œæˆ‘ä¹Ÿç†±æ„›æ—…éŠã€éŸ³æ¨‚èˆ‡é–±è®€ï¼Œå¸Œæœ›å°‡è—è¡“èˆ‡ç§‘æŠ€çµåˆï¼Œç‚ºæ•™å­¸èˆ‡ç ”ç©¶æ³¨å…¥æ›´å¤šå…ƒçš„éˆæ„Ÿèˆ‡è¦–é‡ã€‚</p>

                    <div class="grid-2-cols" style="margin-top: 30px;">
                        <div>
                            <h3 style="color: var(--text-secondary);">ç¶“æ­· (History)</h3>
                            <table class="tech-table">
                                <thead>
                                    <tr>
                                        <th>æ—¥æœŸ</th>
                                        <th>ç¶“æ­·</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>2024-è¿„ä»Š</td>
                                        <td>åœ‹ç«‹å°åŒ—æ•™è‚²å¤§å­¸è³‡è¨Šç§‘å­¸ç³»</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div>
                            <h3 style="color: var(--text-secondary);">æŠ€èƒ½ (Skills)</h3>
                            <table class="tech-table">
                                <tr>
                                    <td>C++</td>
                                    <td>â­â­â­â­</td>
                                </tr>
                                <tr>
                                    <td>Java</td>
                                    <td>â­â­â­</td>
                                </tr>
                                <tr>
                                    <td>Python</td>
                                    <td>â­â­â­</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </article>

        <article id="portfolio" class="fade-in-section">
            <h2 class="section-title">æœ¬å­¸æœŸå°ˆæ¡ˆèˆ‡ä½œå“</h2>
            
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">
                é€™è£¡å±•ç¤ºäº†éŸ³è¨Šã€è¦–è¨ŠåŠ AI ç”Ÿæˆåœ–åƒçš„å‰µä½œæˆæœã€‚
            </p>

            <div class="gallery-grid">
                <div class="media-card">
                    <div style="height: 150px; background: #222; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 3rem;">ğŸµ</span>
                    </div>
                    <div class="media-content">
                        <h3>Neon Dreams (Audio)</h3>
                        <p style="font-size: 0.8rem; color: #888;">åŸå‰µéŸ³æ¨‚ä½œå“</p>
                        <br>
                        <audio controls>
                            <source src="assets/audio/Neon Dreams.mp3" type="audio/mpeg">
                            æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³è¨Šå…ƒç´ ã€‚
                        </audio>
                    </div>
                </div>

                <div class="media-card">
                    <video controls style="width:100%; height: 150px; object-fit: cover;">
                        <source src="assets/video/Gemini_Academic_Powerhouse_Video.mp4" type="video/mp4">
                    </video>
                    <div class="media-content">
                        <h3>Gemini Academic Video</h3>
                        <p style="font-size: 0.8rem; color: #888;">å­¸è¡“æ¨å»£è¦–è¨Š</p>
                    </div>
                </div>

                <div class="media-card">
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background: #000;">
                        <iframe 
                            src="https://www.youtube.com/embed/FzCN11texrc" 
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen 
                            title="Embedded YouTube Video">
                        </iframe>
                    </div>
                    <div class="media-content">
                        <h3>å°ˆæ¡ˆå±•ç¤ºå½±ç‰‡</h3>
                        <p style="font-size: 0.8rem; color: #888;">YouTube å½±ç‰‡å±•ç¤º</p>
                    </div>
                </div>

                <div class="media-card">
                    <img src="assets\images\Gemini_Generated_Image_85mjsn85mjsn85mj.png" alt="Geminiç”Ÿæˆåœ–ç‰‡1" style="width:100%; height: 150px; object-fit: cover;">
                    <div class="media-content">
                        <h3>Gemini ç”Ÿæˆè—è¡“ #1</h3>
                        <p style="font-size: 0.8rem; color: #888;">AI åœ–åƒç”Ÿæˆå¯¦é©—</p>
                    </div>
                </div>

                 <div class="media-card">
                    <img src="assets/images/unnamed.jpg" alt="Geminiç”Ÿæˆåœ–ç‰‡2" style="width:100%; height: 150px; object-fit: cover;">
                    <div class="media-content">
                        <h3>Gemini ç”Ÿæˆè—è¡“ #2</h3>
                        <p style="font-size: 0.8rem; color: #888;">AI åœ–åƒç”Ÿæˆå¯¦é©—</p>
                    </div>
                </div>
            </div>
        </article>

        <section id="others" class="fade-in-section">
            <h2 class="section-title">æ›´å¤šè³‡è¨Š - äº’å‹•ä½œå“</h2>
            
            <div id="chess-root"></div>

            <script type="text/babel">
                const { useState } = React;

                // --- 1. åœ–æ¨™çµ„ä»¶ (SVG) ---
                const RotateCcw = ({ size = 24, className = "" }) => (
                    <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 5v7h7"/></svg>
                );
                const Trophy = ({ size = 24, className = "" }) => (
                    <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
                );
                const AlertTriangle = ({ size = 24, className = "" }) => (
                    <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
                );

                // --- 2. éŠæˆ²å¸¸æ•¸èˆ‡è¨­å®š ---
                const INITIAL_BOARD_SETUP = [
                    [
                        { type: 'r', color: 'b', hasMoved: false }, { type: 'n', color: 'b', hasMoved: false }, { type: 'b', color: 'b', hasMoved: false }, { type: 'q', color: 'b', hasMoved: false },
                        { type: 'k', color: 'b', hasMoved: false }, { type: 'b', color: 'b', hasMoved: false }, { type: 'n', color: 'b', hasMoved: false }, { type: 'r', color: 'b', hasMoved: false },
                    ],
                    Array(8).fill(null).map(() => ({ type: 'p', color: 'b', hasMoved: false })),
                    Array(8).fill(null), Array(8).fill(null), Array(8).fill(null), Array(8).fill(null),
                    Array(8).fill(null).map(() => ({ type: 'p', color: 'w', hasMoved: false })),
                    [
                        { type: 'r', color: 'w', hasMoved: false }, { type: 'n', color: 'w', hasMoved: false }, { type: 'b', color: 'w', hasMoved: false }, { type: 'q', color: 'w', hasMoved: false },
                        { type: 'k', color: 'w', hasMoved: false }, { type: 'b', color: 'w', hasMoved: false }, { type: 'n', color: 'w', hasMoved: false }, { type: 'r', color: 'w', hasMoved: false },
                    ],
                ];

                const PIECE_UNICODE = {
                    w: { k: 'â™”', q: 'â™•', r: 'â™–', b: 'â™—', n: 'â™˜', p: 'â™™' },
                    b: { k: 'â™š', q: 'â™›', r: 'â™œ', b: 'â™', n: 'â™', p: 'â™Ÿ' },
                };

                const ChessPieceIcon = ({ type, color }) => (
                    <div className="w-full h-full flex items-center justify-center pointer-events-none">
                        <span className="text-4xl md:text-5xl text-black font-serif leading-none drop-shadow-sm select-none">
                            {PIECE_UNICODE[color][type] + '\uFE0E'}
                        </span>
                    </div>
                );

                // --- 3. éŠæˆ²ä¸»çµ„ä»¶ ---
                function ChessGame() {
                    const [board, setBoard] = useState(JSON.parse(JSON.stringify(INITIAL_BOARD_SETUP)));
                    const [turn, setTurn] = useState('w');
                    const [selectedPos, setSelectedPos] = useState(null);
                    const [possibleMoves, setPossibleMoves] = useState([]);
                    const [lastMove, setLastMove] = useState(null);
                    const [gameState, setGameState] = useState('playing');
                    const [capturedPieces, setCapturedPieces] = useState({ w: [], b: [] });

                    const isValidPos = (r, c) => r >= 0 && r < 8 && c >= 0 && c < 8;
                    const copyBoard = (b) => b.map(row => row.map(p => p ? { ...p } : null));

                    // --- é‚è¼¯å‡½æ•¸ ---
                    const isSquareAttacked = (r, c, boardState, attackerColor) => {
                        for (let i = 0; i < 8; i++) {
                            for (let j = 0; j < 8; j++) {
                                const piece = boardState[i][j];
                                if (piece && piece.color === attackerColor) {
                                    const moves = getPseudoLegalMoves({ r: i, c: j }, piece, boardState, null, false);
                                    if (moves.some(m => m.to.r === r && m.to.c === c)) return true;
                                }
                            }
                        }
                        return false;
                    };

                    const getPseudoLegalMoves = (pos, piece, currentBoard, prevMove, checkForCastling = true) => {
                        const moves = [];
                        const { r, c } = pos;
                        const direction = piece.color === 'w' ? -1 : 1;

                        const addMove = (tr, tc, special) => {
                            if (!isValidPos(tr, tc)) return;
                            const target = currentBoard[tr][tc];
                            if (target && target.color === piece.color) return;
                            moves.push({ from: pos, to: { r: tr, c: tc }, ...special });
                        };

                        if (piece.type === 'p') {
                            if (isValidPos(r + direction, c) && !currentBoard[r + direction][c]) {
                                addMove(r + direction, c);
                                const startRow = piece.color === 'w' ? 6 : 1;
                                if (r === startRow && isValidPos(r + direction * 2, c) && !currentBoard[r + direction * 2][c]) {
                                    addMove(r + direction * 2, c);
                                }
                            }
                            [[r + direction, c - 1], [r + direction, c + 1]].forEach(([tr, tc]) => {
                                if (isValidPos(tr, tc)) {
                                    const target = currentBoard[tr][tc];
                                    if (target && target.color !== piece.color) addMove(tr, tc);
                                    if (!target && prevMove && prevMove.to.r === r && prevMove.to.c === tc) {
                                        const movedPiece = currentBoard[r][tc];
                                        if (movedPiece && movedPiece.type === 'p' && movedPiece.color !== piece.color && Math.abs(prevMove.from.r - prevMove.to.r) === 2) {
                                            addMove(tr, tc, { isEnPassant: true });
                                        }
                                    }
                                }
                            });
                        } else if (piece.type === 'n') {
                            const offsets = [[-2, -1], [-2, 1], [-1, -2], [-1, 2], [1, -2], [1, 2], [2, -1], [2, 1]];
                            offsets.forEach(([dr, dc]) => addMove(r + dr, c + dc));
                        } else if (piece.type === 'k') {
                            const offsets = [[-1, -1], [-1, 0], [-1, 1], [0, -1], [0, 1], [1, -1], [1, 0], [1, 1]];
                            offsets.forEach(([dr, dc]) => addMove(r + dr, c + dc));
                            if (checkForCastling && !piece.hasMoved && !isSquareAttacked(r, c, currentBoard, piece.color === 'w' ? 'b' : 'w')) {
                                if (isValidPos(r, 7)) {
                                    const rook = currentBoard[r][7];
                                    if (rook && rook.type === 'r' && !rook.hasMoved && !currentBoard[r][5] && !currentBoard[r][6]) {
                                        if (!isSquareAttacked(r, 5, currentBoard, piece.color === 'w' ? 'b' : 'w') && !isSquareAttacked(r, 6, currentBoard, piece.color === 'w' ? 'b' : 'w')) {
                                            addMove(r, 6, { isCastling: 'kingside' });
                                        }
                                    }
                                }
                                if (isValidPos(r, 0)) {
                                    const rook = currentBoard[r][0];
                                    if (rook && rook.type === 'r' && !rook.hasMoved && !currentBoard[r][1] && !currentBoard[r][2] && !currentBoard[r][3]) {
                                        if (!isSquareAttacked(r, 2, currentBoard, piece.color === 'w' ? 'b' : 'w') && !isSquareAttacked(r, 3, currentBoard, piece.color === 'w' ? 'b' : 'w')) {
                                            addMove(r, 2, { isCastling: 'queenside' });
                                        }
                                    }
                                }
                            }
                        } else {
                            const directions = [];
                            if (piece.type === 'b' || piece.type === 'q') directions.push([-1, -1], [-1, 1], [1, -1], [1, 1]);
                            if (piece.type === 'r' || piece.type === 'q') directions.push([-1, 0], [1, 0], [0, -1], [0, 1]);
                            for (const [dr, dc] of directions) {
                                let nr = r + dr;
                                let nc = c + dc;
                                while (isValidPos(nr, nc)) {
                                    const target = currentBoard[nr][nc];
                                    if (!target) { addMove(nr, nc); }
                                    else { if (target.color !== piece.color) addMove(nr, nc); break; }
                                    nr += dr; nc += dc;
                                }
                            }
                        }
                        return moves;
                    };

                    const getLegalMoves = (pos, piece, currentBoard, prevMove) => {
                        const pseudoMoves = getPseudoLegalMoves(pos, piece, currentBoard, prevMove);
                        const legalMoves = [];
                        for (const move of pseudoMoves) {
                            const nextBoard = copyBoard(currentBoard);
                            nextBoard[move.to.r][move.to.c] = { ...piece, hasMoved: true };
                            nextBoard[move.from.r][move.from.c] = null;
                            if (move.isEnPassant) nextBoard[move.from.r][move.to.c] = null;
                            
                            let kingPos = null;
                            for (let r = 0; r < 8; r++) {
                                for (let c = 0; c < 8; c++) {
                                    const p = nextBoard[r][c];
                                    if (p && p.type === 'k' && p.color === piece.color) { kingPos = { r, c }; break; }
                                }
                            }
                            if (kingPos) {
                                if (!isSquareAttacked(kingPos.r, kingPos.c, nextBoard, piece.color === 'w' ? 'b' : 'w')) legalMoves.push(move);
                            }
                        }
                        return legalMoves;
                    };

                    const checkGameState = (currentBoard, nextTurn, prevMove) => {
                        let inCheck = false;
                        let kingPos = null;
                        for (let r = 0; r < 8; r++) {
                            for (let c = 0; c < 8; c++) {
                                const p = currentBoard[r][c];
                                if (p && p.type === 'k' && p.color === nextTurn) { kingPos = { r, c }; break; }
                            }
                        }
                        if (kingPos) inCheck = isSquareAttacked(kingPos.r, kingPos.c, currentBoard, nextTurn === 'w' ? 'b' : 'w');

                        let hasLegalMove = false;
                        for (let r = 0; r < 8; r++) {
                            for (let c = 0; c < 8; c++) {
                                const p = currentBoard[r][c];
                                if (p && p.color === nextTurn) {
                                    if (getLegalMoves({ r, c }, p, currentBoard, prevMove).length > 0) { hasLegalMove = true; break; }
                                }
                            }
                            if (hasLegalMove) break;
                        }

                        if (inCheck && !hasLegalMove) setGameState('checkmate');
                        else if (!inCheck && !hasLegalMove) setGameState('stalemate');
                        else if (inCheck) setGameState('check');
                        else setGameState('playing');
                    };

                    const handleSquareClick = (r, c) => {
                        if (gameState === 'checkmate' || gameState === 'stalemate') return;
                        const clickedPiece = board[r][c];
                        const isSameColor = clickedPiece && clickedPiece.color === turn;

                        if (isSameColor) {
                            setSelectedPos({ r, c });
                            setPossibleMoves(getLegalMoves({ r, c }, clickedPiece, board, lastMove));
                            return;
                        }
                        if (selectedPos) {
                            const move = possibleMoves.find(m => m.to.r === r && m.to.c === c);
                            if (move) executeMove(move);
                            else { setSelectedPos(null); setPossibleMoves([]); }
                        }
                    };

                    const executeMove = (move) => {
                        const newBoard = copyBoard(board);
                        const piece = newBoard[move.from.r][move.from.c];
                        const captured = newBoard[move.to.r][move.to.c];
                        if (captured) setCapturedPieces(prev => ({ ...prev, [piece.color]: [...prev[piece.color], captured.type] }));
                        else if (move.isEnPassant) setCapturedPieces(prev => ({ ...prev, [piece.color]: [...prev[piece.color], 'p'] }));

                        newBoard[move.to.r][move.to.c] = { ...piece, hasMoved: true };
                        newBoard[move.from.r][move.from.c] = null;
                        if (move.isEnPassant) newBoard[move.from.r][move.to.c] = null;
                        if (move.isCastling) {
                            const row = move.to.r;
                            if (move.isCastling === 'kingside') {
                                newBoard[row][5] = { ...newBoard[row][7], hasMoved: true }; newBoard[row][7] = null;
                            } else {
                                newBoard[row][3] = { ...newBoard[row][0], hasMoved: true }; newBoard[row][0] = null;
                            }
                        }
                        if (piece.type === 'p' && (move.to.r === 0 || move.to.r === 7)) newBoard[move.to.r][move.to.c].type = 'q';

                        setBoard(newBoard);
                        setLastMove(move);
                        const nextTurn = turn === 'w' ? 'b' : 'w';
                        setTurn(nextTurn);
                        setSelectedPos(null);
                        setPossibleMoves([]);
                        checkGameState(newBoard, nextTurn, move);
                    };

                    const resetGame = () => {
                        setBoard(JSON.parse(JSON.stringify(INITIAL_BOARD_SETUP)));
                        setTurn('w');
                        setSelectedPos(null);
                        setPossibleMoves([]);
                        setLastMove(null);
                        setGameState('playing');
                        setCapturedPieces({ w: [], b: [] });
                    };

                    const getSquareColor = (r, c) => {
                        return (r + c) % 2 === 0 ? 'bg-[#F0D9B5]' : 'bg-[#B58863]';
                    };

                    // --- æ¸²æŸ“ ---
                    return (
                        <div className="flex flex-col items-center w-full p-4 font-sans select-none rounded-xl" style={{ backgroundColor: 'rgba(20, 20, 20, 0.5)', border: '1px solid #333' }}>
                            
                            {/* æ¨™é¡Œå€ */}
                            <div className="w-full max-w-lg mb-4 flex items-center justify-between">
                                <h1 className="text-2xl font-bold text-white flex items-center gap-2">
                                    <Trophy className="w-6 h-6 text-[#e5c07b]" />
                                    è¥¿æ´‹æ£‹å¤§å¸«
                                </h1>
                                <button onClick={resetGame} className="p-2 bg-[#333] rounded-full shadow-sm hover:bg-[#444] hover:text-[#e5c07b] transition-all active:scale-95 text-gray-300 border border-gray-600" title="é‡æ–°é–‹å§‹">
                                    <RotateCcw size={20} />
                                </button>
                            </div>

                            {/* ç‹€æ…‹å¡ç‰‡ */}
                            <div className={`w-full max-w-lg mb-6 p-4 rounded-xl shadow-sm border flex items-center justify-between transition-colors duration-300
                                ${gameState === 'checkmate' ? 'bg-red-900/50 border-red-700' : 'bg-[#1a1a1a] border-[#333]'}`}>
                                <div className="flex items-center gap-3">
                                    <div className={`w-3 h-3 rounded-full ${turn === 'w' ? 'bg-gray-200 border border-gray-400' : 'bg-black border border-gray-600'}`}></div>
                                    <span className="font-medium text-lg text-gray-200">
                                        {gameState === 'checkmate' ? (turn === 'w' ? 'é»‘æ–¹ç²å‹ï¼' : 'ç™½æ–¹ç²å‹ï¼') : 
                                        gameState === 'stalemate' ? 'é€¼å’Œ (Stalemate)' :
                                        turn === 'w' ? 'è¼ªåˆ°ç™½æ–¹' : 'è¼ªåˆ°é»‘æ–¹'}
                                    </span>
                                </div>
                                {(gameState === 'check' || gameState === 'checkmate') && (
                                    <div className="flex items-center gap-1 text-red-400 font-bold px-3 py-1 bg-red-900/30 rounded-lg border border-red-800">
                                        <AlertTriangle size={18} />
                                        {gameState === 'check' ? 'å°‡è»!' : 'å°‡æ­»!'}
                                    </div>
                                )}
                            </div>

                            {/* é»‘æ–¹åƒæ‰çš„æ£‹å­ */}
                            <div className="w-full max-w-lg h-8 flex gap-1 mb-2 px-2 overflow-hidden items-end">
                                {capturedPieces.b.map((p, i) => (
                                    <div key={i} className="w-6 h-8 text-white/70 text-2xl flex items-center justify-center font-serif">
                                        {PIECE_UNICODE['w'][p] + '\uFE0E'}
                                    </div>
                                ))}
                            </div>

                            {/* æ£‹ç›¤ä¸»é«” */}
                            <div className="relative shadow-2xl rounded overflow-hidden border-4 border-[#333]">
                                <div className="grid grid-cols-8 grid-rows-8 w-[min(85vw,480px)] h-[min(85vw,480px)]">
                                    {board.map((row, r) => (
                                        row.map((piece, c) => {
                                            const isSelected = selectedPos?.r === r && selectedPos?.c === c;
                                            const move = possibleMoves.find(m => m.to.r === r && m.to.c === c);
                                            const isMoveOption = !!move;
                                            const isCaptureTarget = isMoveOption && (piece || move.isEnPassant);
                                            const isKingInCheck = gameState !== 'playing' && gameState !== 'stalemate' && piece?.type === 'k' && piece?.color === turn;

                                            return (
                                                <div key={`${r}-${c}`} onClick={() => handleSquareClick(r, c)}
                                                    className={`
                                                        relative flex items-center justify-center cursor-pointer
                                                        ${getSquareColor(r, c)}
                                                        ${isKingInCheck ? '!bg-[#FF6961]' : ''}
                                                        ${isSelected ? 'shadow-[inset_0_0_0_4px_#4CAF50] after:content-[""] after:absolute after:inset-0 after:bg-[#4CAF50]/30' : ''}
                                                    `}
                                                >
                                                    {/* åæ¨™ */}
                                                    {c === 0 && <span className={`absolute top-0.5 left-0.5 text-[10px] font-bold ${getSquareColor(r, c).includes('F0D9B5') ? 'text-[#B58863]' : 'text-[#F0D9B5]'}`}>{8 - r}</span>}
                                                    {r === 7 && <span className={`absolute bottom-0 right-1 text-[10px] font-bold ${getSquareColor(r, c).includes('F0D9B5') ? 'text-[#B58863]' : 'text-[#F0D9B5]'}`}>{String.fromCharCode(97 + c)}</span>}

                                                    {/* ç§»å‹•æç¤º */}
                                                    {isMoveOption && !isCaptureTarget && (
                                                        <div className="absolute w-[30%] h-[30%] bg-[#4CAF50]/80 rounded-full pointer-events-none z-10"></div>
                                                    )}
                                                    {isCaptureTarget && (
                                                        <div className="absolute w-[90%] h-[90%] border-[4px] border-[#ef4444] rounded-lg pointer-events-none z-10"></div>
                                                    )}

                                                    {/* æ£‹å­ */}
                                                    {piece && <div className="w-full h-full z-20 relative"><ChessPieceIcon type={piece.type} color={piece.color} /></div>}
                                                </div>
                                            );
                                        })
                                    ))}
                                </div>
                            </div>

                            {/* ç™½æ–¹åƒæ‰çš„æ£‹å­ */}
                            <div className="w-full max-w-lg h-8 flex gap-1 mt-2 px-2 overflow-hidden items-start">
                                {capturedPieces.w.map((p, i) => (
                                    <div key={i} className="w-6 h-8 text-white/70 text-2xl flex items-center justify-center font-serif">
                                        {PIECE_UNICODE['b'][p] + '\uFE0E'}
                                    </div>
                                ))}
                            </div>

                            <div className="mt-4 flex flex-col items-center gap-1 text-xs text-gray-500 font-sans">
                                <p>é»æ“Šæ£‹å­é€²è¡Œç§»å‹• â€¢ æ”¯æ´éè·¯å…µ â€¢ è‡ªå‹•å‡è®Šç‚ºçš‡å</p>
                                <p className="text-[#e5c07b]">Designed by Wang Meng-Fan</p>
                            </div>
                        </div>
                    );
                }

                // --- 4. æ¸²æŸ“åˆ° DOM ---
                const root = ReactDOM.createRoot(document.getElementById('chess-root'));
                root.render(<ChessGame />);
            </script>
        </section>

        <section id="contact" style="border-bottom: none;">
            <div style="text-align: center;">
                <h2>æº–å‚™å¥½é–‹å§‹åˆä½œäº†å—ï¼Ÿ</h2>
                <p style="color: var(--text-secondary); margin: 20px 0;">æ­¡è¿éš¨æ™‚é€éé›»å­éƒµä»¶èˆ‡æˆ‘è¯ç¹«</p>
                <a href="mailto:s111316020@stu.ntue.edu.tw" class="btn-cta">ç™¼é€éƒµä»¶</a>
            </div>
        </section>
    </main>

    <footer class="contact-footer">
        <p>Email: s111316020@stu.ntue.edu.tw</p>
        <p style="color: var(--text-secondary); font-size: 0.8rem; margin-top: 10px;">
            Â© 2025 Wang Meng-Fan. All Rights Reserved. <br>
            <time datetime="2025-12-13">æœ€å¾Œæ›´æ–°æ—¥æœŸï¼š2025å¹´12æœˆ15æ—¥</time>
        </p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // 1. æ¼¢å ¡é¸å–®äº’å‹•é‚è¼¯
            const menuToggle = document.getElementById('mobile-menu');
            const navLinks = document.getElementById('nav-links');

            if (menuToggle && navLinks) {
                menuToggle.addEventListener('click', () => {
                    navLinks.classList.toggle('active');
                    // åˆ‡æ›åœ–ç¤º
                    menuToggle.textContent = navLinks.classList.contains('active') ? 'âœ•' : 'â˜°';
                });

                // é»æ“Šé€£çµå¾Œè‡ªå‹•é—œé–‰é¸å–® (å„ªåŒ–æ‰‹æ©Ÿé«”é©—)
                navLinks.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                        navLinks.classList.remove('active');
                        menuToggle.textContent = 'â˜°';
                    });
                });
            }

            // 2. æ»¾å‹•è¦–å·®èˆ‡æ·¡å…¥å‹•ç•« (Intersection Observer)
            const observerOptions = {
                threshold: 0.1, // ç•¶å…ƒç´ å‡ºç¾ 10% æ™‚è§¸ç™¼
                rootMargin: "0px 0px -50px 0px"
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); 
                    }
                });
            }, observerOptions);

            const fadeElements = document.querySelectorAll('.fade-in-section');
            fadeElements.forEach(el => observer.observe(el));

            // 3. åœ–ç‰‡å³éµä¿è­·
            const protectImages = document.querySelectorAll('img');
            protectImages.forEach(img => {
                img.addEventListener('contextmenu', (e) => e.preventDefault());
                img.addEventListener('dragstart', (e) => e.preventDefault());
            });

            console.log("System Initialized: Wang Meng-Fan Portfolio Loaded.");
        });
    </script>
</body>
</html>